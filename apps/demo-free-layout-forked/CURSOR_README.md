# Flowgram å¼€å‘æ³¨æ„äº‹é¡¹

## ğŸ”§ æœ€æ–°ä¿®å¤ (2025-01-05)

### å®ä½“å±æ€§ç¼–è¾‘é—®é¢˜ä¿®å¤

1. **å®ä½“metaå±æ€§ç¼–è¾‘**
   - âœ… ä¿®å¤äº†metaå±æ€§keyæ ¼å¼é—®é¢˜ï¼šä»`meta_${entity.id}_id`æ”¹ä¸ºå›ºå®šçš„`__entity_id`æ ¼å¼
   - âœ… ç°åœ¨FormEntityMetaså¯ä»¥æ­£ç¡®æ‰¾åˆ°å¯¹åº”çš„Fieldè¿›è¡Œç¼–è¾‘

2. **å±æ€§å¢åˆ dirtyçŠ¶æ€**
   - âœ… åœ¨FormOutputsçš„handleAttributeChangeä¸­æ·»åŠ äº†`setIsEntityDirty(true)`è°ƒç”¨
   - âœ… ç°åœ¨å±æ€§å¢åˆ åä¼šæ­£ç¡®è§¦å‘ä¿å­˜/æ’¤é”€æŒ‰é’®å¯ç”¨

3. **ğŸ‰ å®ç°useClonedæ•°æ®ç®¡ç†æœºåˆ¶**
   - âœ… åˆ›å»ºäº†`src/hooks/use-cloned.ts`ï¼Œæä¾›reactiveçš„blurå±æ€§å’Œresetå‡½æ•°
   - âœ… æ›´æ–°äº†EditableEntityAttributeTableä½¿ç”¨useClonedæœºåˆ¶
   - âœ… è‡ªåŠ¨ç®¡ç†ä¿®æ”¹çŠ¶æ€ï¼ˆisModifiedï¼‰
   - âœ… æä¾›ç®€å•çš„é‡ç½®åŠŸèƒ½ï¼ˆresetï¼‰
   - âœ… åˆ é™¤äº†å¤æ‚çš„æ‰‹åŠ¨å†å²ç®¡ç†ä»£ç 

4. **å¾…éªŒè¯é—®é¢˜**
   - ğŸ” å®ä½“å±æ€§ç±»å‹é€‰æ‹©å™¨æ˜¯å¦å¯ä»¥æ­£å¸¸ä¿®æ”¹
   - ğŸ” é¡µé¢å‚ç›´æ»šåŠ¨æ¡çš„å…·ä½“åŸå› 

### æµ‹è¯•æ­¥éª¤

1. å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼š`npm run dev`
2. é€‰æ‹©ä¸€ä¸ªå®ä½“ï¼Œæ‰“å¼€ä¾§è¾¹æ ç¼–è¾‘å™¨
3. æµ‹è¯•metaå±æ€§ç¼–è¾‘ï¼ˆIDã€åç§°ã€æè¿°ï¼‰
4. æµ‹è¯•å®ä½“å±æ€§çš„ç±»å‹ä¿®æ”¹
5. æµ‹è¯•å±æ€§å¢åˆ åä¿å­˜æŒ‰é’®æ˜¯å¦å¯ç”¨
6. æ£€æŸ¥é¡µé¢æ˜¯å¦æœ‰ä¸å¿…è¦çš„å‚ç›´æ»šåŠ¨æ¡

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### nanoidç´¢å¼•è®¾è®¡æ¨¡å¼
- ä½¿ç”¨nanoidä½œä¸ºReact keyï¼Œç¡®ä¿ç»„ä»¶ç¨³å®šæ€§
- å±æ€§ç¼–è¾‘æ—¶åªä¿®æ”¹name/typeç­‰å­—æ®µï¼Œä¸åŠ¨nanoid key
- è¯¦è§ï¼š[entity-properties-editor-design.mdc](entity-properties-editor-design.mdc)

### æ•°æ®è½¬æ¢æµç¨‹
- EntityStore â†’ entityToWorkflowData() â†’ WorkflowEditor
- å®ä½“metaå±æ€§ä½¿ç”¨å›ºå®škeyï¼š`__entity_id`ã€`__entity_name`ã€`__entity_description`
- å®ä½“å±æ€§ä½¿ç”¨nanoidä½œä¸ºkeyï¼Œä¿ç•™åŸå§‹id/nameåœ¨å¯¹åº”å­—æ®µä¸­

## ğŸš¨ å¼€å‘çº¦æŸ

- âŒ **ç¦æ­¢ä¿®æ”¹**ï¼š`packages/` ç›®å½•ä¸‹çš„å¼•æ“ä»£ç 
- âœ… **è‡ªç”±ä¿®æ”¹**ï¼š`src/components/ext/` ä¸‹çš„æ‰€æœ‰æ‰©å±•ä»£ç 
- âš ï¸ **è°¨æ…ä¿®æ”¹**ï¼šå…¶ä»–åŸæœ‰çš„å·¥ä½œæµç¼–è¾‘å™¨ç›¸å…³ä»£ç 

## ğŸ“ å…³é”®æ–‡ä»¶

- å®ä½“è½¬æ¢ï¼š`src/utils/entity-to-workflow.ts`
- å±æ€§ç¼–è¾‘ï¼š`src/form-components/form-outputs/index.tsx`
- Metaç¼–è¾‘ï¼š`src/form-components/form-entity-metas/index.tsx`
- å®ä½“å­˜å‚¨ï¼š`src/components/ext/entity-store/index.tsx`

## ğŸ› å·²çŸ¥é—®é¢˜

1. ç±»å‹é€‰æ‹©å™¨å¯èƒ½æ— æ³•ä¿®æ”¹ï¼ˆå¾…éªŒè¯ï¼‰
2. é¡µé¢å¯èƒ½å‡ºç°å‚ç›´æ»šåŠ¨æ¡ï¼ˆå¾…å®šä½ï¼‰

## ğŸ“ å¼€å‘æ—¥å¿—

### 2025-01-05
- ä¿®å¤å®ä½“metaå±æ€§ç¼–è¾‘é—®é¢˜
- ä¿®å¤å±æ€§å¢åˆ ådirtyçŠ¶æ€é—®é¢˜
- é‡æ„æ•°æ®è½¬æ¢é€»è¾‘ï¼Œä½¿ç”¨å›ºå®škeyæ ¼å¼
