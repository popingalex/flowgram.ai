# 实体编辑工作副本重构任务

**任务目标**: 重构实体编辑机制，使用简洁的工作副本模式，解决焦点丢失和数据结构复杂问题

## 核心问题
1. 当前的 `_editing` 嵌套结构过于复杂诡异
2. 动态切换数据源导致组件重渲染，输入框焦点丢失
3. 状态管理分散（isDirty、isSaving等），应该统一为一个status

## 解决方案
使用UUID管理工作副本的简洁设计：
- Store分离原始数据和工作副本
- 页面始终使用工作副本，不切换数据源
- 通过对比自动计算状态

## 实施步骤

### 1. 重构Store数据结构 ✅
- [x] 移除Entity接口中的_editing字段
- [x] 添加workingCopies字典管理
- [x] 实现核心API：startEditing、getWorkingCopy、resetWorkingCopy

### 2. 重构页面组件 ✅
- [x] 修改entity-list-page.tsx使用新的工作副本API
- [x] 移除复杂的getDisplayEntity逻辑
- [x] 确保页面始终使用工作副本数据

### 3. 测试验证
- [ ] 验证输入框不再丢失焦点
- [ ] 验证多实体同时编辑
- [ ] 验证撤销和保存功能

## 预期效果
- 解决输入框焦点丢失问题
- 简化数据结构，提升可维护性
- 支持多实体同时编辑

## 进度记录
- 2024-XX-XX: 完成Store重构和页面组件修改
- 待测试: 验证功能是否正常工作
